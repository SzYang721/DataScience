
## ------------------------------------------------------------------------
library(ISLR)
data(Carseats)

mod <- lm(Sales ~ Price + Urban + US, data=Carseats)
summary(mod)


## ------------------------------------------------------------------------
p.value <- 2*pt(-4.63, df=396)
p.value


## ------------------------------------------------------------------------
mod2 <- lm(Sales ~ Price + US, data=Carseats)
summary(mod2)


## ------------------------------------------------------------------------
confint(mod2)


## ------------------------------------------------------------------------
1.19964 - qt(0.975, df=397)*0.25846
1.19964 + qt(0.975, df=397)*0.25846


## ------------------------------------------------------------------------
boxplot(mod2$res)


## ------------------------------------------------------------------------
box <- boxplot(mod2$res, plot=FALSE)
box$out


## ------------------------------------------------------------------------
X <- model.matrix(mod2)
H <- X%*%solve(t(X)%*%X)%*%t(X)
h.i <- diag(H)
h.i[1:5]


## ------------------------------------------------------------------------
lev <- influence(mod2)$hat
lev[1:5]


## ------------------------------------------------------------------------
library(faraway)
halfnorm(lev, ylab="Leverages", nlab=length(lev[lev>2*(3)/400]))
abline(h=2*(3)/400, lwd=3, col="red")


## ------------------------------------------------------------------------
set.seed(1)
n <- 100
x1 <- runif(n)
x2 <- 0.5*x1+rnorm(n)/10
y <- 2 + 2*x1 + 0.3*x2 + rnorm(n)


## ------------------------------------------------------------------------
cor(x1, x2)


## ------------------------------------------------------------------------
plot(x2, x1, pch=16, col="blue")


## ------------------------------------------------------------------------
mod <- lm(y ~ x1 + x2)
summary(mod)


## ------------------------------------------------------------------------
mod2 <- lm(y ~ x1)
summary(mod2)


## ------------------------------------------------------------------------
mod3 <- lm(y ~ x2)
summary(mod3)


## ------------------------------------------------------------------------
x1 <- c(x1, 0.1)
x2 <- c(x2, 0.8)
y <- c(y, 6)

par(mfrow=c(2,2))
plot(x1, y); points(x1[101], y[101], pch=21, col="red")
plot(x2, y); points(x2[101], y[101], pch=21, col="red")
plot(x2, x1); points(x2[101], x1[101], pch=21, col="red")


## ------------------------------------------------------------------------
mod4 <- lm(y ~ x1 + x2)
summary(mod4)
lev <- influence(mod4)$hat
halfnorm(lev, ylab="Leverages", nlab=length(lev[lev>2*(3)/101]))
abline(h=2*(3)/101, lwd=3, col="red")
lev[101]


